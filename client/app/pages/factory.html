<!--
 Copyright (C) 2016  DING Changchang (of Canaan Creative)

 This file is part of Avalon Management System (AMS).

 AMS is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 AMS is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with AMS. If not, see <http://www.gnu.org/licenses/>.
-->
<md-content layout="column" layout-align="center center" flex ng-if="!vm.auth.success">
	<div>Login Required</div>
	<md-button class="md-raised md-primary" ng-click="vm.showDialog('login')">Login</md-button>
</md-content>
<md-content layout="row" layout-align="center center" flex ng-if="!vm.loaded && vm.auth.success">
	<md-progress-circular class="md-accent" md-mode="indeterminate"></md-progress-circular>
</md-content>
<md-card ng-if="!!vm.loaded && vm.auth.success" flex>
	<md-card-header layout="row">
		<md-card-header-text>
			<div class="md-title">Orders</div>
		</md-card-header-text>
		<span flex="auto"></span>
		<md-input-container class="ams-searching">
			<input aria-label="Order Search" ng-model="vm.search" ng-cloak />
		</md-input-container>
		<md-button class="md-raised md-primary" ng-click="vm.searchOrder(vm.search)">
			<ng-md-icon icon="search"></ng-md-icon>
		</md-button>
		<md-button class="md-raised md-primary" ng-click="vm.newOrder()">
			<ng-md-icon icon="add"></ng-md-icon>
		</md-button>
		<md-button class="md-raised md-primary" ng-click="vm.setting()">
			<ng-md-icon icon="settings"></ng-md-icon>
		</md-button>
	</md-card-header>
	<md-card-content layout="row" layout-align="center center" flex ng-if="!vm.searchDone">
		<md-progress-circular class="md-accent" md-mode="indeterminate"></md-progress-circular>
	</md-card-content>
	<md-card-content layout="row" layout-align="center center" ng-if="vm.searchDone && !vm.data.order_search" flex>
		<div>无记录</div>
	</md-card-content>
	<md-card-content layout="row" ng-if="vm.searchDone && !!vm.data.order_search" flex>
		<div layout="column" flex="50">
			<h3 class="md-title">订单信息</h3>
			<div>
				<span>订单编号: &nbsp;</span>
				<span>{{ vm.data.order_search.order_id }}</span>
			</div>
			<div>
				<span>投产数量: &nbsp;</span>
				<span>{{ vm.data.order_search.quantity }}</span>
			</div>
			<div>
				<span>工艺文件编号: &nbsp;</span>
				<span>{{ vm.data.order_search.doc_id }}</span>
			</div>
			<div>
				<span>生产批次: &nbsp;</span>
				<span>{{ vm.data.order_search.batch }}</span>
			</div>
			<div>
				<span>备注: &nbsp;</span>
				<span>{{ vm.data.order_search.note }}</span>
			</div>
		</div>
		<div layout="column" flex>
			<h3 class="md-title">产品信息</h3>
			<div layout="column" flex>
				<!--
				<div>
					<span>产品名称:</span>
					<span>{{ vm.data.order_search.product_sn }}</span>
				</div>
				<div>
					<span>产品型号:</span>
					<span>{{ vm.data.order_search.product_sn }}</span>
				</div>
				-->
				<div>
					<span>产品序列号: &nbsp;</span>
					<span>{{ vm.data.order_search.product_sn }}</span>
				</div>
				<div>
					<span>日期: &nbsp;</span>
					<span>{{ vm.data.order_search.time.toLocaleDateString() }}</span>
				</div>
			</div>
			<div flex="5"></div>
			<h3 class="md-title">组件信息</h3>
			<div layout="column" flex>
				<div layout="row" class="ams-column" layout-align="center center">
					<p class="md-body-2" flex="10">名称</p>
					<p class="md-body-2" flex="10">型号</p>
					<p class="md-body-2" flex="30">序列号</p>
					<p class="md-body-2" flex="40">领用日期</p>
					<p class="md-body-2" flex="10">备注</p>
				</div>
				<div ng-repeat="b in vm.data.order_search.components" class="ams-column" layout="row">
					<div flex="10">
						<span>{{ b.name }}</span>
					</div>
					<div flex="10">
						<span>{{ b.model }}</span>
					</div>
					<div flex="30">
						<span>{{ b.component_sn }}</span>
					</div>
					<div flex="40">
						<span>{{ b.time.toLocaleDateString() }}</span>
					</div>
					<div flex="10">
						<span>{{ b.note }}</span>
					</div>
				</div>
			</div>
		</div>
		<!--
		<md-table-container>
			<table md-table md-progress="deferred">
				<thead md-head>
					<tr md-row>
						<th md-column ng-repeat="column in vm.table" ng-cloak>
							{{ column.name }}
							<md-tooltip ng-if="column.tooltip !== undefined" ng-cloak>
								{{ column.tooltip }}
							</md-tooltip>
						</th>
					</tr>
				</thead>
				<tbody md-body>
					<tr md-row md-on-select="vm.openOrder" ng-repeat="order in vm.data.orders">
						<td md-cell ng-repeat="column in vm.table" ng-cloak>
							{{ column.value(order) }}
						</td>
					</tr>
				</tbody>
			</table>
		</md-table-container>
		-->
	</md-card-contain>
</md-card>
