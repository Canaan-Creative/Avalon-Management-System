<!--
 Copyright (C) 2015-2016  DING Changchang (of Canaan Creative)

 This file is part of Avalon Management System (AMS).

 AMS is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 AMS is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with AMS. If not, see <http://www.gnu.org/licenses/>.
-->
<md-content layout="column" flex>
	<div layout="row">
		<div flex="50">
			<md-card>
				<md-card-header>
					<md-card-header-text>
						<div class="md-title">Hashrate Graph</div>
					</md-card-header-text>
				</md-card-header>
				<md-card-content ng-if="!vm.hashrateChart.loaded" layout="row" layout-align="center center">
					<div style="height:{{ vm.hashrateChart.options.chart.height }}px" layout="column" layout-align="center center">
						<md-progress-circular class="md-accent" md-mode="indeterminate"></md-progress-circular>
					</div>
				</md-card-content>
				<md-card-content ng-if="vm.hashrateChart.loaded">
					<nvd3 options="vm.hashrateChart.options" data="vm.data.farmHashrate">
					</nvd3>
				</md-card-content>
			</md-card>
		</div>
		<div flex>
			<md-card>
				<md-card-header>
					<md-card-header-text>
						<div class="md-title">Aliverate Graph</div>
					</md-card-header-text>
				</md-card-header>
				<md-card-content ng-if="!vm.aliverateChart.loaded" layout="row" layout-align="center center">
					<div style="height:{{ vm.aliverateChart.options.chart.height }}px" layout="column" layout-align="center center">
						<md-progress-circular class="md-accent" md-mode="indeterminate"></md-progress-circular>
					</div>
				</md-card-content>
				<md-card-content ng-if="vm.aliverateChart.loaded">
					<nvd3 options="vm.aliverateChart.options" data="vm.data.aliverate">
					</nvd3>
				</md-card-content>
			</md-card>
		</div>
	</div>
	<md-content layout="row" flex>
		<md-content flex="50">
			<md-card>
				<md-card-header>
					<md-card-header-text>
						<div class="md-title">Summary</div>
					</md-card-header-text>
				</md-card-header>
				<md-card-content ng-if="!vm.summaryLoaded" layout="row" layout-align="center center">
					<div layout="column" layout-align="center center">
						<md-progress-circular class="md-accent" md-mode="indeterminate"></md-progress-circular>
					</div>
				</md-card-content>
				<md-card-content ng-if="vm.summaryLoaded">
					<md-data-table-container>
						<table md-data-table md-progress="deferred">
							<thead>
								<tr>
									<th ng-repeat="column in vm.summaryTable" name="{{ column.name }}"></th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="node in vm.data.summary" ng-click="vm.gotoDetail(node.ip, node.port)">
									<td ng-repeat="column in vm.summaryTable">
										{{ column.value(node) }}
									</td>
								</tr>
							</tbody>
						</table>
					</md-data-table-container>
				</md-card-content>
			</md-card>
		</md-content>

		<md-content flex>
			<md-card>
				<md-card-header>
					<md-card-header-text>
						<div class="md-title">Issues</div>
					</md-card-header-text>
				</md-card-header>
				<md-card-content ng-if="!vm.issueLoaded" layout="row" layout-align="center center">
					<div layout="column" layout-align="center center">
						<md-progress-circular class="md-accent" md-mode="indeterminate"></md-progress-circular>
					</div>
				</md-card-content>
				<md-card-content ng-if="vm.issueLoaded">
					<md-data-table-container>
						<table md-data-table md-progress="deferred">
							<thead>
								<tr>
									<th name="ID"></th>
									<th name="Issue"></th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="node in vm.data.issue.node" ng-click="vm.gotoDetail(node.ip, node.port)">
									<td>{{ node.ip }}:{{ node.port }}</td>
									<td>Connection failed</td>
								</tr>
								<tr ng-repeat="module in vm.data.issue.ec" ng-click="vm.gotoDetail(module.ip, module.port, module.dna)">
									<td>{{ module.ip }}:{{ module.port }} {{ module.device_id }}:{{ module.module_id }} {{ module.dna }}</td>
									<td>{{ vm.ecDecode(module.ec) }}</td>
								</tr>
							</tbody>
						</table>
					</md-data-table-container>
				</md-card-content>
			</md-card>
		</md-content>
	</md-content>
</md-content>
